/*
 ? 2017 Andrew Banks ALL RIGHTS RESERVED */
(function(y){function n(c){if(u[c])return u[c].exports;var k=u[c]={i:c,l:!1,exports:{}};y[c].call(k.exports,k,k.exports,n);k.l=!0;return k.exports}var u={};n.m=y;n.c=u;n.i=function(c){return c};n.d=function(c,k,p){n.o(c,k)||Object.defineProperty(c,k,{configurable:!1,enumerable:!0,get:p})};n.n=function(c){var k=c&&c.__esModule?function(){return c["default"]}:function(){return c};n.d(k,"a",k);return k};n.o=function(c,k){return Object.prototype.hasOwnProperty.call(c,k)};n.p="";return n(n.s=0)})([function(y,
n){(function(n){function c(p){if(k[p])return k[p].exports;var b=k[p]={i:p,l:!1,exports:{}};n[p].call(b.exports,b,b.exports,c);b.l=!0;return b.exports}var k={};c.m=n;c.c=k;c.i=function(c){return c};c.d=function(p,b,k){c.o(p,b)||Object.defineProperty(p,b,{configurable:!1,enumerable:!0,get:k})};c.n=function(p){var b=p&&p.__esModule?function(){return p["default"]}:function(){return p};c.d(b,"a",b);return b};c.o=function(c,b){return Object.prototype.hasOwnProperty.call(c,b)};c.p="";return c(c.s=1)})([function(n,
c){n.exports=Redux},function(n,c,k){function p(b){if(Array.isArray(b)){for(var c=0,k=Array(b.length);c<b.length;c++)k[c]=b[c];return k}return Array.from(b)}var b="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(b){return typeof b}:function(b){return b&&"function"===typeof Symbol&&b.constructor===Symbol&&b!==Symbol.prototype?"symbol":typeof b},u=k(0),y=function(){function c(a,b){if(a===b)return!0;var f=Object.keys(a),d=Object.keys(b);if(f.length!==d.length)return!1;for(var d=
Object.prototype.hasOwnProperty,c=0;c<f.length;c++)if(!d.call(b,f[c])||a[f[c]]!==b[f[c]])return!1;return!0}function k(a,f){R(f);var c=f.partitionName;a[c]={};var h=a[c];Object.keys(f.changers).forEach(function(c){var q=c+"Reducer";"undefined"===b(f.reducers[q])&&d("'Reducer: "+q+" not found.");h[c]=S(a,f,c,q)});h.subscribe=T(c);h.getState=U(a,c)}function n(a){var c=[];"undefined"!==b(a.changerDefinitions)&&(c=Object.keys(a.changerDefinitions));"undefined"!==b(a.changers)&&(c=[].concat(p(c),p(Object.keys(a.changers))));
c.forEach(function(a){V.some(function(b){return b===a})&&d(a+" is an invalid changer name.")});W.forEach(function(c){"undefined"===b(a[c])&&d(c+" is a required entry in "+a.partitionName+".")});Object.keys(a).forEach(function(b){X.some(function(a){return b===a})||d(b+" is not a valid entry in "+a.partitionName+".")})}function O(a){a=[a];v=v.concat(a);a.forEach(function(a){n(a);Y(a);k(t,a)})}function P(){z=w({},0<arguments.length&&void 0!==arguments[0]?arguments[0]:{});z.onStateChange&&("function"!==
typeof z.onStateChange&&d("options.onStateChange must be a function."),G=z.onStateChange);z.onListener&&("function"!==typeof z.onListener&&d("options.onListener must be a function."),F=z.onListener)}function Z(a,f,h){var k=3<arguments.length&&void 0!==arguments[3]?arguments[3]:{};"undefined"===("undefined"===typeof a?"undefined":b(a))&&d("Missing first parameter partitionDefinitions.");P(k);a.forEach(function(a){A[a.partitionName]=w({},a.defaultState)});var B={};"undefined"!==("undefined"===typeof f?
"undefined":b(f))?[].concat(p(Object.keys(A)),p(Object.keys(f))).forEach(function(a){B[a]=w({},A[a],f[a])}):B=void 0;H=D(function(){var a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:A,b=arguments[1];I||(I=a);if("function"!==typeof b.reducer)return a;var d={};v.forEach(function(b){d[b.partitionName]=a[b.partitionName]});d[b.partitionName]=b.reducer(a[b.partitionName],b);if(c(d[b.partitionName],a[b.partitionName]))return a;Q(b.partitionName,b.type,b.operation,a[b.partitionName],d[b.partitionName],
b.changerName,b.theirArgs);J[b.partitionName]=!0;return d},B,h);t=Object.create(H);t.subscribe(function(){var a=t.getState(),c=function(c){E.forEach(function(d){if(c===d.partitionName)if(0===d.stateEntries.length)K(c,a[c],d.listenerName),d.listener(a[c]);else{var g=!0;"undefined"===b(d.prevState)?d.stateEntries.forEach(function(b){g=g&&a[c][b]===I[c][b]}):d.stateEntries.forEach(function(b){g=g&&a[c][b]===d.prevState[b]});if(!g){var e={};d.stateEntries.forEach(function(b){e[b]=a[c][b]});d.prevState=
e;K(c,e,d.listenerName);d.listener(e)}}})},d;for(d in J)c(d);J={}});a.forEach(function(a){O(a)});return t}var h={STATE_COPY:1,STATE_ARRAY_ADD:2,STATE_ARRAY_DELETE:3,STATE_ARRAY_ENTRY_MERGE:4,STATE_OBJECT_MERGE:5,STATE_TOGGLE:6,STATE_FUNCTION_CALL:7,STATE_SETTODEFAULTS:8,STATE_INCREMENT:9,STATE_DECREMENT:10},aa="arguments impliedArguments type operation arrayName keyIndexerName keyName arrayArgShape".split(" "),V=["getState","subscribe"],X=["partitionName","defaultState","changers","reducers","changerDefinitions"],
W=["partitionName","defaultState"],A={},t=null,H=null,J={},E=[],ba=0,v=[],z={},G=null,F=null,I=null,L=[],M=[],D=void 0;"undefined"!==("undefined"===typeof u.createStore?"undefined":b(u.createStore))&&(D=u.createStore);"undefined"===("undefined"===typeof D?"undefined":b(D))&&("undefined"!==("undefined"===typeof Redux?"undefined":b(Redux))?D=Redux.createStore:d("Redux is undefined"));var d=function(a){throw Error("CausalityRedux: "+a);},w=Object.assign,x=function(a){return Object.prototype.toString.call(a).slice(8,
-1)},N=function(a){return y.partitionDefinitions.find(function(b){return a===b.partitionName})},Q=function(a,c,d,h,k,q,p){"function"===typeof G&&(a={partitionName:a,type:c,operation:"undefined"===("undefined"===typeof d?"undefined":b(d))?"User defined":d,prevState:h,nextState:k,changerName:q,args:p},G(a))},K=function(a,b,c){"function"===typeof F&&F({partitionName:a,nextState:b,listenerName:c})},ca=function(a,b){var c=arguments[3],d=w([],2<arguments.length&&void 0!==arguments[2]?arguments[2]:[]),c=
{id:ba++,listener:a,partitionName:b,stateEntries:d,listenerName:c};E.push(c);return c.id},da=function(a){E=E.filter(function(b){return b.id!==a})},S=function(a,c,h,k){return function(){var f,q=(f=c.changers)[h].apply(f,arguments);if("undefined"===b(c.changerDefinitions[h])){if("undefined"===("undefined"===typeof q?"undefined":b(q))||"Object"!==x(q)){d("Changer "+h+" must return an action object.");return}}else if("undefined"===("undefined"===typeof q?"undefined":b(q)))return;q.type="undefined"===
b(q.type)?"":q.type;q.reducer=c.reducers[k];q.partitionName=c.partitionName;q.reducerName=k;a.dispatch(q)}},T=function(a){return function(c,h){var f=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"";Array.isArray(h)||d("subscribe: the 2nd argument must be an array of keys to listen on.");var k=N(a);h.forEach(function(c){var f=!1;"undefined"!==b(k.defaultState[c])?f=!0:Object.keys(k.changerDefinitions).forEach(function(a){a===c&&(1<h.length&&d("Can only subscribe to one changer event."),f=
!0)});if(!f)throw c+" is not a valid key in the state partition "+a+".";});return function(a){return function(){da(a)}}(ca(c,a,h,f))}},U=function(a,b){return function(){return a.getState()[b]}},R=function(a){"undefined"===b(a.partitionName)&&d("partitionName not found.");"undefined"===b(a.defaultState)&&d("defaultState missing from entry: "+a.partitionName);"undefined"===b(a.changers)&&d("changers missing from entry: "+a.partitionName);"undefined"===b(a.reducers)&&d("reducers missing from entry: "+
a.partitionName)},Y=function(a){if(a.changerDefinitions){var c=function(a){return a===h.STATE_ARRAY_ADD||a===h.STATE_ARRAY_DELETE||a===h.STATE_ARRAY_ENTRY_MERGE},k=function(a,c,g,e){e.length!==g.length&&d("Incorrect number of arguments for "+c+" call.");for(var m=0;m<e.length;++m)"undefined"===b(a[g[m]])?d('Invalid argument name "'+g[m]+'" for '+c+" call."):"Object"!==x(a[g[m]])&&x(a[g[m]])!==x(e[m])&&d("Incorrect argument type for argument #"+(m+1)+" for "+c+" call.")},n=function(a,c){var d=Object.keys(a),
e=Object.keys(c),m="";d.some(function(d){"undefined"===b(c[d])?m=d+" is missing in the first argument":a[d]!==x(c[d])&&(m="Invalid type for "+d+" in the first argument");return""!==m});""===m&&e.some(function(c){"undefined"===b(a[c])&&(m="'"+c+"' is an invalid field in the first argument");return""!==m});return m},C=function(l){Object.keys(l).forEach(function(b){aa.some(function(a){return b===a})||d(b+" is an invalid entry in "+a.partitionName+".")});"undefined"!==b(l.arguments)&&(Array.isArray(l.arguments)||
d("'arguments' must be an array for '"+o+"' in partitionName = "+a.partitionName+"."));c(l.operation)?("undefined"!==b(l.keyIndexerName)&&"undefined"===b(l.keyName)&&d("The keyIndexerName is defined in "+o+" but keyName is not defined."),"undefined"===b(a.defaultState[l.arrayName])?d("Missing the 'arrayName' definition for entry '"+o+"' in partitionName = "+a.partitionName+"."):Array.isArray(a.defaultState[l.arrayName])||d(l.arrayName+" is not an array for entry '"+o+"' in partitionName = "+a.partitionName+
".")):l.operation===h.STATE_TOGGLE?("undefined"!==b(l.impliedArguments)&&0!==l.impliedArguments.length||d("impliedArguments is required for '"+o+"' in partitionName = "+a.partitionName+"."),l.impliedArguments.forEach(function(b){"Boolean"!==x(a.defaultState[b])&&d("The impliedArgument "+b+" is not Boolean as required by the Toggle operation in '"+o+"' of partitionName = "+a.partitionName+".")})):l.operation===h.STATE_INCREMENT||l.operation===h.STATE_DECREMENT?("undefined"!==b(l.impliedArguments)&&
1===l.impliedArguments.length||d("impliedArguments with 1 entry is required for '"+o+"' in stateName = "+a.stateName+"."),l.impliedArguments.forEach(function(b){"Number"!==x(a.defaultState[b])&&d("The impliedArgument "+b+" is not a Number as required by the "+l.operation+" operation in '"+o+"' of partitionName = "+a.partitionName+".")})):l.operation===h.STATE_OBJECT_MERGE?("undefined"!==b(l.arguments)&&0!==l.arguments.length||d("'arguments' is required for '"+o+"' in partitionName = "+a.partitionName+
"."),1!==l.arguments.length&&d("STATE_OBJECT_MERGE allows only 1 argument for '"+o+"' in partitionName = "+a.partitionName+".")):l.operation===h.STATE_SETTODEFAULTS&&("undefined"!==b(l.impliedArguments)&&0!==l.impliedArguments.length||d("'impliedArguments' is required for '"+o+"' in partitionName = "+a.partitionName+"."))},q=function(l,f,g){return function(){for(var e=arguments.length,m=Array(e),q=0;q<e;q++)m[q]=arguments[q];var r=[].concat(m);if(g.operation===h.STATE_FUNCTION_CALL){var C=[];E.forEach(function(a){Array.isArray(a.stateEntries)||
d("Listenername="+a.listenerName+", partitionName="+a.partitionName+" is not an array.");a.stateEntries.forEach(function(b){b===f&&C.push(a)})});0===C.length&&d("There is no subscriber to "+f+" in "+l+".");if(g.impliedArguments){var u=t[l].getState();if(u){var v={};g.impliedArguments.forEach(function(a){v[a]=u[a]});r.push(v)}}var B={functionArguments:r};Q(l,f,g.operation,{},B,f,r);C.forEach(function(a){K(l,B,a.listenerName);a.listener.apply(a,p(r))})}else{e={};e.changerName=f;e.theirArgs=r;e.type=
"undefined"===b(g.type)?f:g.type;e.arguments="undefined"===b(g.arguments)?[]:g.arguments;e.impliedArguments="undefined"===b(g.impliedArguments)?[]:g.impliedArguments;e.operation="undefined"===b(g.operation)?h.STATE_COPY:g.operation;e.partitionName=l;if(c(g.operation))g.operation===h.STATE_ARRAY_ADD&&"Object"!==x(r[0])&&d("STATE_ARRAY_ADD can only accept pure base objects. You must define your own changers and reducers for this object."),g.operation===h.STATE_ARRAY_ADD||g.operation===h.STATE_ARRAY_DELETE?
(1!==r.length&&d("Only one argument is allowed with "+g.operation+" for entry '"+f+"' in partitionName = "+a.partitionName+"."),g.operation===h.STATE_ARRAY_ADD&&"undefined"!==b(g.arrayArgShape)&&(m=n(g.arrayArgShape,r[0]),""!==m&&d(m+" for "+f))):(2!==r.length&&d("Two arguments are required with "+g.operation+" for entry '"+f+"' in partitionName = "+a.partitionName+"."),"undefined"!==b(g.arrayArgShape)&&(m=n(g.arrayArgShape,r[1]),""!==m&&d(m+" for "+f))),e.arrayArg=g.operation===h.STATE_ARRAY_DELETE||
g.operation===h.STATE_ARRAY_ENTRY_MERGE?r[0].toString():r[0],e.arrayEntryArg=r[1],e.arrayName=g.arrayName,e.keyIndexerName=g.keyIndexerName,e.keyName=g.keyName;else if(g.operation===h.STATE_OBJECT_MERGE)1!==r.length&&d("STATE_OBJECT_MERGE allows only 1 argument for "+f+"."),e[e.arguments[0]]=r[0];else if(g.operation===h.STATE_SETTODEFAULTS||g.operation===h.STATE_TOGGLE)0!==r.length&&d(g.operation+" allows only 0 arguments for "+f);else if(g.operation!==h.STATE_FUNCTION_CALL&&(k(a.defaultState,f,e.arguments,
r),0<r.length))for(m=0;m<r.length;++m)e[e.arguments[m]]=r[m];return e}}},u=function(a,c){return function(g,e){var f=w({},g);g=[];var l=g=void 0;"undefined"===b(e.operation)&&(e.operation=h.STATE_COPY);switch(e.operation){case h.STATE_COPY:e.arguments.forEach(function(a){f[a]=e[a]});break;case h.STATE_TOGGLE:e.impliedArguments.forEach(function(a){f[a]=!f[a]});break;case h.STATE_INCREMENT:e.impliedArguments.forEach(function(a){f[a]+=1});break;case h.STATE_DECREMENT:e.impliedArguments.forEach(function(a){--f[a]});
break;case h.STATE_SETTODEFAULTS:c.impliedArguments.forEach(function(a){f[a]=A[e.partitionName][a]});break;case h.STATE_ARRAY_ADD:g=[].concat(p(f[e.arrayName]));e.keyIndexerName&&(l=parseInt(f[e.keyIndexerName])||0,e.arrayArg[e.keyName]=l.toString(),++l,f[e.keyIndexerName]=l.toString());g.push(e.arrayArg);f[e.arrayName]=g;break;case h.STATE_ARRAY_DELETE:g=f[e.arrayName].filter(function(a){return a[e.keyName]!==e.arrayArg});f[e.arrayName]=g;break;case h.STATE_ARRAY_ENTRY_MERGE:g=[].concat(p(f[e.arrayName]));
l=f[e.arrayName].findIndex(function(a){return a[e.keyName]===e.arrayArg});0<=l&&(g[l]=w(g[l],e.arrayEntryArg),f[e.arrayName]=g);break;case h.STATE_OBJECT_MERGE:g=e.arguments[0];f[g]=w(f[g],e[g]);break;default:d("Unknown operation entry in "+a+".")}return f}},v=function(a){return function(b,c){return a(b,c)}};"undefined"===b(a.changers)&&(a.changers={});Object.keys(a.changerDefinitions).forEach(function(c){var f=a.changerDefinitions[c];"undefined"===("undefined"===typeof f?"undefined":b(f))&&d("Changer definition argument for "+
c+" must be defined");C(f);a.changers[c]=q(a.partitionName,c,f);var g=c+"Reducer",e=void 0;"undefined"!==b(a.reducers)&&(e=a.reducers[g]);"undefined"!==("undefined"===typeof e?"undefined":b(e))?a.reducers[g]=v(e):("undefined"===b(a.reducers)&&(a.reducers={}),a.reducers[g]=u(c,f))})}};return{createStore:function(){var a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],c=arguments[1],h=arguments[2],k=arguments[3];null!==t&&d("CausalityRedux is already initialized.");a=a.filter(function(a){return"undefined"===
b(N(a.partitionName))});a=v.concat(a);v=[];t=Z(a,c,h,k);L.forEach(function(a){return a()});L=[];M.forEach(function(a){"undefined"===b(t[a.partitionName])&&d("${e.partitionName} is an invalid partition.");t[a.partitionName].subscribe(a.listener,a.arrKeys,a.listenerName)});M=[];return t},addPartitions:function(a){Array.isArray(a)||(a=[a]);a=a.filter(function(a){return"undefined"===b(N(a.partitionName))});null!==t?a.forEach(function(a){A[a.partitionName]=w({},a.defaultState);O(a)}):v=v.concat(a)},subscribe:function(a,
c,h,k){"function"!==typeof c&&d("subscribe listener argument is not a function.");Array.isArray(h)||d("subscribe: the 3rd argument must be an array of keys to listen on.");null!==t?("undefined"===b(t[a])&&d("${partitionName} is an invalid partition."),t[a].subscribe(c,h,k)):M.push({partitionName:a,listener:c,arrKeys:h,listenerName:k})},onStoreCreated:function(a){"function"!==typeof a&&d("onStoreCreated argument is not a function.");null!==t?a():L.push(a)},setOptions:P,get store(){return t},get reduxStore(){return H},
get operations(){return h},get partitionDefinitions(){return v},get onListener(){return F},get defaultState(){return A},get shallowEqual(){return c},get merge(){return w}}}();"undefined"!==typeof window&&(window.CausalityRedux=y);n.exports=y}])}]);
